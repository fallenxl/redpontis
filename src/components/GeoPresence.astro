---
import { Image } from "astro:assets";
import mapLatam from "../assets/map.svg";
---

<section id="presence" class="relative overflow-hidden bg-white">
  <!-- Decor sutil de marca -->
  <div class="pointer-events-none absolute inset-0">
    <div class="absolute -top-28 left-1/2 h-[46rem] w-[46rem] -translate-x-1/2 rounded-full bg-[#B41A1D]/10 blur-3xl"></div>
    <div class="absolute bottom-[-18%] right-[-12%] h-[34rem] w-[34rem] rounded-full bg-[#575756]/10 blur-3xl"></div>
  </div>

  <div class="relative mx-auto max-w-7xl px-4 md:px-6 pt-16 md:pt-24 flex flex-col items-center md:flex-row">
    <header class="text-center md:text-left max-w-3xl">
      <p class="text-xs md:text-sm uppercase tracking-[0.2em] text-[#575756] flex items-center gap-2 justify-center md:justify-start" >
        <span class="inline-block h-[3px] w-8 rounded bg-[#B41A1D]"></span>
        <span data-i18n="presence.kicker">Nuestra presencia</span>
      </p>
      <h2 class="heavitas mt-2 text-3xl md:text-5xl leading-tight text-[#121212]" data-i18n="presence.title" data-i18n-html>
        Presencia en <span class="text-[#B41A1D]">LATAM</span>
      </h2>
      <p class="mt-3 text-[#575756] md:text-lg text-balance" data-i18n="presence.subtitle">
        Operamos en múltiples países de la región, impulsando el ecosistema de pagos con soluciones ágiles y seguras.
      </p>
    </header>

    <!-- Mapa -->
    <div class="relative mx-auto max-w-5xl">
      <div class="mx-auto w-full">
        <Image
          src={mapLatam}
          alt="Mapa de presencia de Red Pontis en LATAM"
          class="mx-auto h-auto w-full max-w-[880px] rounded-full object-contain border-none"
          widths={[640, 768, 1024, 1280]}
          sizes="(max-width: 1024px) 90vw, 880px"
          loading="lazy"
          data-i18n-attr="alt"
          data-i18n-alt="presence.mapAlt"
        />
      </div>
    </div>
  </div>
</section>

<script>
  import gsap from "gsap";
  import ScrollTrigger from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);

  const section = document.querySelector<HTMLElement>("#presence");
  if (section) {
    gsap.from(section, {
      opacity: 0,
      y: 26,
      duration: 0.7,
      ease: "power3.out",
      scrollTrigger: { trigger: section, start: "top 85%", once: true }
    });
  }

  // Reaplicar traducción al cambiar idioma
  window.addEventListener("rp:langchange", () => {
    (window as any).rpI18n?.apply?.(document.getElementById("presence")!);
  });
</script>
